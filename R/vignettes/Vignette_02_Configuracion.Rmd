---
title: "Vignette 02: Configuracion"
author: "Grace Smith-Vidaurre"
date: "2023-12-27"
output: 
  html_document:
    css: "styles.css"
    toc: true
    toc_float: true
    toc_depth: 4
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(echo = TRUE, eval = FALSE)

```

<h2>Resumen del tutorial y objetivos de aprendizaje</h2>

In this second vignette, we will set up a virtual workspace for coding sessions with the ABISSMAL R functions. You will learn basic R programming skills and open science tips for writing code, including:

1. How to use RMarkdown files
2. Cleaning your global environment
3. Running code inside of an RMarkdown chunk
4. Learning about R functions and documentation
5. Installing and loading packages
6. Commenting code
7. Coding shortcuts in RStudio
8. Creating and using a working directory

<h2>Using RMarkdown files</h2>

Each vignette in this series is available as an RMarkdown file (extension .Rmd) and as an HTML file that can be viewed in your default Internet browser. Each HTML file was generated by knitting the output of an RMarkdown file. You can check out the [RMarkdown documentation](https://rmarkdown.rstudio.com/lesson-1.html) for more information about how to use this file format to write code and knit the code output into reports.

RMarkdown files facilitate sharing your code and the output of your code with others. If you're new to using RMarkdown, the best way to work through these vignettes will be to create a new RMarkdown file for each vignette and write out the code from each vignette yourself. You will get the most coding practice out of these vignettes if you write out the code and comments in your own words (outside and inside of chunks). You can open the knitted output for each vignette in your Internet browser as a guide while you write code in your own RMarkdown file. Or you can open the vignette RMarkdown file and your own RMarkdown file side by side in RStudio by adding a third column in the pane layout:

* Tools
* Global Options
* Pane Layout
* Select the Add Column option to add another Source pane in a third column
* Open the original vignette RMarkdown file in one source pane, and your own RMarkdown file in the other source pane

If you're already familiar with writing R code and using RMarkdown files, then you can open the original RMarkdown file for each vignette and run the code inside each file as you work through each vignette (with some modification of paths to reflect folders and files on your local computer). If you want to preserve the original code in each RMarkdown file, you can create a copy of each vignette and modify the copies instead. 

<h2>Clean your global environment</h2>

Your global environment is your virtual workspace in R, and can hold different packages and objects to facilitate your data analysis and programming objectives. You can see the different packages and objects currently loaded in your environment by clicking on the tab "Environment" in the pane that also includes the "History" and "Connections" tab. 

If you started a new RStudio session then your global environment will likely be empty. But if you're working in an older session or maybe in an RProject workspace, then your global environment will likely have packages and objects already loaded. Cleaning your global environment can be good practice to ensure that you're starting a new coding session with a fresh workspace. If you don't clean your global environment, even when using the same code between sessions, then you risk using old versions of objects that don't reflect your newest changes to the code.

You can clean your global environment directly from the RStudio interface by clicking on the broom icon below the "Environment" tab (hit "Yes" with "hidden objects" selected). 

You can also clean your global environment by running the code below. You can run the code inside this chunk in different ways:

* Click on the small green arrow icon on the top right side of the chunk to run the code in this chunk only

* Place your cursor anywhere within the line of code, then go up to the "Run" icon on the top right of the Source pane that has a white square and green arrow. In the dropdown menu that appears, select "Run Selected Lines" or "Run Current Chunk" (see the keyboard shortcuts next to each)

* Place your cursor anywhere within the line of code and use the keyboard shortcut Ctrl + Enter to run the current line of code

* Place your cursor anywhere within the line of code and use the keyboard shortcut Ctrl + Shift + Enter to run all code in the current chunk

The first keyboard shortcut to run one line of code at a time can be helpful to see the output of each line of code at a time and check for errors.
```{r}

rm(list = ls())

```

The code above to clean your global environment is a nested expression with 2 functions: `rm()` and `ls()`. The `()` notation is used for functions in R. Functions are operations that you can apply in your own code by using the name of a specific function. R has a set of base functions that you can access without loading any additional packages, including the two functions above (`rm()` and `ls()`).

<h2>Access R function documentation</h2>

You can access the documentation for these functions by clicking on the "Help" tab in the pane that also has "Files" and "Plots", and typing the name of the function in the search bar. You can also access function documentation by running the following code:
```{r}

?rm

```

```{r}

?ls

```

For each function, the documentation holds specific sections that can be useful for understanding how the function works, especially the function's arguments. A function's arguments are the values that it expects the user to provide in order to guide or customize the operation. Many functions will have preset default values for some arguments that will be used when you don't provide specific values for arguments. 

For instance, the function `rm()` has an argument called `list` (followed by an `=`, which is used to pass a specific value to the argument). In order for `rm()` to clean your global environment in the way that you want, you need to provide information after the argument `list`. To remove everything in your global environment, we're using the output of the function `ls()`, which is a function that lists the names of all of the objects in your global environment.

<h2>Install and load packages</h2>

After cleaning the global environment, you still need to set up your virtual workspace for the upcoming coding session. One important step here is to make sure you have access to functions that you need but which aren't accessible through the base R functions. For instance, [the `tidyverse`](https://www.tidyverse.org/) is a set of R packages that provide useful functions and expressions for data science purposes. 

If you don't already have tidyverse installed on your local computer, then you need to install the tidyverse in order to access these functions. The code below installs the tidyverse from [CRAN](https://cran.r-project.org/), the Comprehensive R Archive Network that holds thousands of R packages online.
```{r}

# Install the tidyverse from CRAN
install.packages("tidyverse")

```

In the chunk above, I added a comment using the `#` symbol. Any text that you write after a `#` symbol will be treated as text and will not be run as code. It's good practice to comment your code, especially as you're learning more about how to code in R. For biologists, continuing to comment your code even when you're a coding expert can also be good practice. Commenting and documenting your work makes the code that you publish with manuscripts or software tools more accessible to others in the community.

Once you've installed the tidyverse on your computer, you do not need to install it again. But you do need to use the function `library()` to load the package into your global environment in order to access functions that are held inside of the tidyverse packages:
```{r}

library(tidyverse)

```

<h2>Coding shortcuts</h2>

RStudio has a number of useful keyboard shortcuts for writing code. You can find these shortcuts by going to Tools at the header of the RStudio window, then Keyboard Shortcuts Help, which will pull up a popup window with all of the default keyboard shortcuts. You already learned some keyboard shortcuts above about how to run code inside of an RMarkdown chunk. Some additional useful keyboard shortcuts are "Shift + Ctrl + C", which can be used to comment one or multiple lines of code or create new comments, and "Ctrl + Alt + I", which automatically creates a new RMarkdown chunk.

Another useful type of shortcut provided by RStudio is tab completion of code. For instance, in the chunk below, after writing `libr` and pressing Tab, you should see a small popup window appear that lists all of the available functions, packages, or objects that start with the pattern "libr". You can use the arrow keys to select the option that you'd like and hit Enter to complete the line (for instance, to write `library()` for loading a package).
```{r eval = FALSE}

libr

```

<h2>Troubleshooting incomplete statements</h2>

As you write and run code in RStudio, it's important to keep an eye on the console. When you see the symbol `>` in the console, this means that the console finished running code and is ready for another operation. However, when you see the symbol `+` in the console, this means that the statement you just ran was incomplete. Incomplete lines of code can occur when you have a typo so that a statement isn't fully closed, like when you miss an opening or closing parenthesis in a function. Below is an example of an incomplete statement:
```{r eval = FALSE}

library(tidyverse

```

When you run the code above, you should see a `+` symbol appear in the console. This is because you're missing a parenthesis to close the function `library()`. There are two ways to solve this problem. First, if you know what is missing from the statement, you can type the missing bit into the console and hit "Enter". Or, you can click in the console, and then press "Esc", which will remove the incomplete statement and restart the console for additional code. It's good practice to keep an eye on the console to check that the code you're running is producing output. If you run a lot of code and don't see the output that you expect, it may be because you included an incomplete statement, and it would be better to clean the console and check your code before running it again.

<h2>Create your working directory</h2>

The next important step for setting up your virtual workspace is to decide on the working directory that you will use for the coding session. A directory is a location (a folder) on your computer where R will search for files to read in. When you write out files from R, those files can also be written to your working directory.

You can use the function `getwd()` to check your current working directory.
```{r eval = TRUE}

getwd()

```

My working directory is set by default to the folder on my computer where I saved this RMarkdown file. To work in a separate directory that holds only data generated from these vignettes, you can create a new directory or folder on your computer:
```{r}

?dir.create

dir.create("/home/gsvidaurre/Desktop/ABISSMAL_vignettes")

```

In the code above, you'll need to replace the path (or the list of folder names) to reflect where you want to save the new folder called `ABISSMAL_vignettes` (or another name of your choice) on your own computer. For those using Windows, if you copy and paste a path into R directly from your computer then you may need to change the direction of the slashes.

In introductory R coding courses, it's common to formally set your working directory before a coding session by using the function `setwd()`. It's good practice to avoid using `setwd()` in code that that you want to share with collaborators or share more widely in the spirit of open science (e.g. accompanying a publication or a new tool). When you use `setwd()` and share the code with others, you're assuming that someone else has the same working directory on their computer, which generally will not be true. There are other ways in which you can specify your working directory throughout your code without using `setwd()`.

For instance, let's say that we want to make a copy of the first vignette and then save that copy inside of the directory that we created above. We can use a base R functions to copy and save the file to the correct working directory. You will need to update the paths below to reflect the folder where the vignettes are saved on your computer, as well as your own working directory:
```{r}

file.copy(
  from = "/home/gsvidaurre/Desktop/GitHub_repos/ABISSMAL/R/vignettes/Vignette_01_Introduction.Rmd",
  to = "/home/gsvidaurre/Desktop/ABISSMAL_vignettes/Vignette_01_Introduction_copy.Rmd"
    )

```

In the code above, we're specifying 2 arguments to the function `file.copy()`. The first argument specifies the location of the file that we want to copy (/home/gsvidaurre/Desktop/GitHub_repos/ABISSMAL/R/vignettes/) and the name of the file (Vignette_01_Introduction.Rmd). The second argument specifies the location where we want to save this copy (/home/gsvidaurre/Desktop/ABISSMAL_vignettes/), and a new file name for the copied file (Vignette_01_Introduction_copy.Rmd). In each argument, the file paths are surrounded by 2 double quotes, in order to indicate that the text inside each pair of quotes should be considered character information or a "character string" (a formal term for text included in R code).

When you run the line of code above, the output in the console should read "[1] TRUE" if the file was successfully copied and saved. You can check that the function worked correctly by opening a file window on your computer in this new directory. You can also use the base R function `list.files()` to check whether the copied file exists in the working directory. The output of `list.files()` is a list of all of the files contained within the new directory, and that list should contain a single file: "Vignette_01_Introduction_copy.Rmd".
```{r}

list.files(path = "/home/gsvidaurre/Desktop/ABISSMAL_vignettes")

```

The code above is an example of how you can specify your working directory in the code that you write without needing to use `setwd()`. In the following vignettes, you will see other examples of how to specify your working directory without `setwd()`. Before moving on to the next vignette, you can remove the file that you copied to your working directory:

```{r}

file.remove("/home/gsvidaurre/Desktop/ABISSMAL_vignettes/Vignette_01_Introduction_copy.Rmd")

```

In the next vignette, you will start creating and manipulating objects in R that can be used in the ABISSMAL data processing and analysis pipeline.

<h2>Información sobre esta traducción</h2>

Este tutorial fue traducido al español por Grace Smith-Vidaurre, siguiendo las [convenciones de traduccion de los Carpentries](https://github.com/Carpentries-ES/board/blob/master/Convenciones_Traduccion.md), incluyendo usar el genero femenino por defecto. Si encuentran errores de ortografía que impiden su habilidad de completar estos tutoriales, por favor reporten los errores de ortografía a GitHub usando los pasos arriba para reportar un "Issue" con los tutoriales.